<template>
	<div
		class="sidebar--menu">
		<div class="sidebar--menu--header">
			<slot name="header"/>
		</div>
		<div class="sidebar--menu--body">
			<slot/>
		</div>
		<div class="sidebar--menu--footer">
			<slot name="footer"/>
			<div class="app--appearance-settings">
				<button
					type="button"
					class="toggle-theme-button"
					:title="isDarkTheme ? 'Zum Light Theme wechseln' : 'Zum Dark Theme wechseln (Work in progress!)'"
					@click="toggleDarkTheme"
				>
					<template v-if="isDarkTheme">
						<svws-ui-icon><i-ri-sun-line /></svws-ui-icon>
					</template>
					<template v-if="!isDarkTheme">
						<svws-ui-icon><i-ri-moon-line /></svws-ui-icon>
					</template>
				</button>
			</div>
			<div class="sidebar--menu--footer-credits">
				<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 999.38 999.4" class="hidden">
					<path d="M0 999.4V0h999.38v999.4H0Zm16.8-16.82h965.85V16.99H16.8v965.59Z"/>
					<path
						d="M550.24 667.44c-3.89-10.01-8.14-20.27-11.89-30.71a478.83 478.83 0 0 1-28.43-158.47 13.46 13.46 0 0 1 3.23-8.3c11.47-12.87 26.5-17.87 43.28-18.22 1.53-.03 3.74 1.83 4.58 3.38 19.66 36.28 39.17 72.65 58.71 108.99 3.69 6.87 7.4 13.72 11.68 21.65 9.1-38.5 27.91-70.72 53.43-99.45l-60.16-47.17c-24.25-19.02-48.47-38.08-72.81-56.99a11.93 11.93 0 0 0-6.7-2.31c-11.62-.23-23.25-.11-35.12-.11V37.23h317.81c-1.53 10.63-3.27 20.96-4.43 31.36a512.83 512.83 0 0 0-2.47 31.83c-.14 2.85-1.13 4.09-3.37 5.3-10.4 5.61-20.71 11.37-31.08 17.04-24.73 13.53-45.66 32.26-67.65 49.52-25.56 20.06-50.91 40.38-76.39 60.53-8.52 6.74-15.71 14.42-18.82 25.16-.5 1.71-.72 3.5-1.05 5.18 9.79 4.01 13.51 8.7 13.16 16.28-.35 7.52-4.31 11.84-13.34 14.55-.44 12.39 9.56 22.9 21.54 22.47 1.36-.05 2.81-.89 4-1.69 2.77-1.84 5.37-3.95 8.12-5.83 2.78-1.9 4.69-4 5.65-7.6.77-2.9 3.24-5.86 5.76-7.69 8.96-6.5 23.89-6.27 33.05 0 8.32 5.69 8.54 15.31-.19 20.27-4.59 2.61-10.21 4.04-15.51 4.59-4.02.42-7.28 1.26-10.36 3.79-3.33 2.73-6.92 5.14-11 8.13 17.86 6.85 35.34 11.87 54.01 8.05 13.44-2.74 22.99-10.8 27.01-23.98 3.57-11.69 11.57-17.36 22.74-19.81 15.62-3.42 31.42-2.82 47.25-2.32 20.64.65 41.28 1.29 61.93 1.48 20.33.18 34.84-9.58 44.02-27.49 2.2-4.29 4.28-8.68 5.89-13.2 1.13-3.17 2.72-4.39 6.11-4.46 15.13-.31 24.07 12.38 17.64 26.5-12.87 28.29-33.9 46.08-65.94 48.67-5.13.41-10.27.76-14.21 1.05-5.97 12.89-10.86 25.65-17.52 37.4-12.71 22.42-30.9 40.41-49.84 57.56-27.65 25.04-56.13 49.22-82.99 75.09-26.09 25.14-46.34 54.73-55.79 90.28-3.73 14.04-5 28.76-7.07 43.21-.41 2.87-1.12 4.44-3.94 5.38-33.61 11.21-67.18 22.52-100.77 33.78-.28.09-.64-.04-1.77-.15ZM37.2 496.81V37.27H373c-1.18 2.92-2.21 5.5-3.26 8.06-16.27 39.61-27.74 80.8-39.91 121.76-11.33 38.12-23.48 75.93-40.12 112.18-26.37 57.45-66.33 103.19-119.34 137.14-33.48 21.44-68.1 41.1-102.19 61.6-8.84 5.32-17.59 10.81-26.38 16.2-1.36.83-2.77 1.57-4.61 2.61ZM36.51 961.18c.59-2.56.78-4.04 1.27-5.4 15.96-43.74 31.59-87.61 48.04-131.17 16.1-42.64 35.98-83.37 63.49-120.07 25.18-33.58 56.95-59.75 92.3-81.61 32.27-19.95 65.36-38.58 97.96-58.01 30.69-18.29 60.18-38.23 85.33-63.92 23.76-24.27 41.72-52.63 57.87-82.25 2.11-3.87 4.16-7.77 6.54-12.22.26 1.15.45 1.58.44 2.01-.6 35.47.19 71.02-2.15 106.37-3.84 57.85-19.36 113.03-44.41 165.31-49.92 104.19-126.9 181.92-230.45 233.09-46.6 23.02-95.88 37.71-147.44 44.54-9.21 1.22-18.45 2.14-28.78 3.33ZM503.28 962.58c-26.82 0-53.65-.07-80.47.09-3.63.02-5.78-1.09-7.59-4.18-4.54-7.77-7.88-15.83-7.08-25.02.73-8.39 4.96-14.74 12.21-18.93 3.25-1.88 3.25-4.88 2.07-7.31-1.06-2.19-3.52-5.06-5.55-5.21-17.89-1.34-26.92-8.36-29.63-26.14-3.65-23.96 3.25-44.91 21.39-61.41 10.06-9.15 24.8-12.83 37.06-1.88 2.85 2.54 5.36.97 7.59-.76 2.19-1.7 4.15-3.47 2.88-7.11-4.62-13.26-1.54-23.25 9.33-31.79 19.88-15.62 56.14-15.4 75.79.47 10.45 8.43 13.42 18.31 8.92 31-1.32 3.73.47 5.8 2.92 7.6 2.48 1.82 4.93 2.7 8.04.2 9.69-7.81 19.88-8.51 30.55-1.95 15.47 9.52 23.26 24.32 26.92 41.51 2.32 10.9 2.23 21.86-1.88 32.46-4.68 12.07-13.27 18.04-26.06 17.55-4.14-.16-5.79 1.97-6.83 5.1-1.05 3.16-.89 5.84 2.6 8.08 10.15 6.5 13.75 16.45 10.92 28.65a46.05 46.05 0 0 1-1.27 4.3c-4.65 13.61-6.15 14.69-20.37 14.69h-72.47Zm60.94-82.31c-.4-33.74-27.99-60.98-61.46-60.68-33.6.3-61.2 28.16-60.82 61.39.39 33.56 28.2 61.02 61.53 60.77 33.51-.26 61.14-28.21 60.75-61.47ZM682.26 761.87c1.96 4.01 3.6 7.57 5.41 11.05 16.7 32.14 41.14 57.37 71.45 76.52 25.86 16.34 52.75 31.04 79.25 46.36 25.45 14.71 49.96 30.66 70.4 52.11 1.92 2.02 3.79 4.08 5.69 6.13l-.61 1.32c-16.26-3.98-32.72-7.28-48.74-12.04-119.65-35.57-212.93-106.3-280.37-211.22-.92-1.43-1.3-3.21-1.94-4.83 1.81-.5 3.65-1.51 5.42-1.42 40.39 2.11 80.77 4.34 121.15 6.55 13.13.72 26.25 1.87 39.38 2.08 23.15.37 38.85-11.57 49.28-31.39 3.63-6.89 9.89-8.45 16.45-3.74 6.12 4.39 9.39 13.74 6.49 22.04a46.48 46.48 0 0 1-8.32 14.54c-17.21 20.18-38.82 30.74-65.85 29.04-19.27-1.22-38.56-2.09-57.84-3.09-1.96-.1-3.92-.01-6.71-.01Z"/>
					<path
						d="M962.31 37.31v40.67l-53.4-7.4c3.3 13.48 4.45 26.36 1.77 39.25-2.89 13.92-17.18 21.43-29.45 15.89-5.2-2.35-5.93-3.89-3.95-9.07 10.93-28.61.76-51.89-18.38-72.91-1.89-2.07-3.91-4.02-6.26-6.43H962.3ZM809.8 190.19c-13.02 7.03-25.52 13.45-40.49 10.76-.33-.06-.66-.09-.98-.17-7.97-1.95-14.37-8.4-13.51-13.61 1.91-11.53 8.88-18.2 18.74-17.29a37.7 37.7 0 0 1 11.44 3.16c9.18 4.02 17.16 9.9 24.81 17.15ZM610.7 914.46c2.57-1.98 6.38-4.42 9.55-7.51 3.06-2.98 5.47-6.64 8.44-10.34 7.58 7.91 12.26 17.46 14.76 28.11.26 1.09-1.14 2.99-2.26 3.92-7.82 6.46-16.71 10.77-25.93 12.61l-4.55-26.79ZM557.96 765.75a58.4 58.4 0 0 1 29.23-4.96c1.33.11 3.26 1.16 3.73 2.28 4.15 9.73 5.7 19.87 4.52 29.62l-25.93-3.77-11.55-23.18ZM448 765.63l-11.47 23.54-25.57 3.7c-1.29-10 .28-20.4 4.64-30.4.38-.86 1.98-1.59 3.08-1.68 10.44-.83 20.49.77 29.33 4.84ZM395.39 915.65l-4.43 25.54c-9.57-1.84-18.79-6.43-26.8-13.42a4.64 4.64 0 0 1-1.17-3.89c2.55-10.13 7.09-19.25 13.82-26.45l18.58 18.22ZM503.07 841.58c22.12-.02 39.27 17.15 39.2 39.24a38.78 38.78 0 0 1-39.1 38.92c-21.79.02-39.19-17.2-39.23-38.82-.04-22.17 17.03-39.33 39.13-39.35Z"/>
				</svg>
				<div class="opacity-25">SVWS</div>
				<div v-if="$slots.version" class="opacity-25 break-all"><slot name="version"/></div>
				<div class="meta-navigation">
					<slot name="metaNavigation"/>
				</div>
			</div>
		</div>
	</div>
</template>

<script setup lang="ts">
import { onMounted, ref } from "vue";

const isDarkTheme = ref(false);

onMounted(() => {
	if (
		localStorage.getItem("darkmode") === "true" &&
		isDarkTheme.value === false
	) {
		toggleDarkTheme();
	}
});

function toggleDarkTheme() {
	isDarkTheme.value = !isDarkTheme.value;
	window.localStorage.setItem(
		"darkmode",
		String(isDarkTheme.value)
	);
	if (isDarkTheme.value) {
		document.body.classList.add("theme-dark");
	} else {
		document.body.classList.remove("theme-dark");
	}
};
</script>

<style lang="postcss">
.sidebar--menu {
	@apply flex min-h-full flex-1 flex-col;
	@apply w-12;
}

@media (min-width: 1280px) {
	.sidebar--menu {
		@apply w-20 px-1;
	}
}

.sidebar--menu--body {
	@apply flex-1;
}

.sidebar--menu--body,
.sidebar--menu--footer {
	@apply flex flex-col;
}

.sidebar--menu--collapsed .sidebar--menu--body,
.sidebar--menu--collapsed .sidebar--menu--footer {
	@apply px-1;
}

.sidebar--menu--footer-credits {
	@apply text-center mt-2 mb-1 flex flex-col justify-end leading-none;
	font-size: 0.78rem;
}

.sidebar--menu--footer-credits svg {
	@apply w-9 mx-auto mb-3;
}

.meta-navigation {
	@apply text-center mt-2;

	a {
		@apply text-ellipsis overflow-hidden opacity-25;
		max-width: 100%;
		display: -webkit-box;
		-webkit-box-orient: vertical;
		-webkit-line-clamp: 1;
		word-break: break-all;

		&:hover,
		&:focus {
			@apply opacity-100;
		}
	}
}

.app--appearance-settings {
	@apply mt-4 mb-2 pt-4 border-t-2 border-dark-20 border-opacity-20;
	@apply flex justify-center;
}
</style>
